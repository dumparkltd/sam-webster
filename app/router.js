define(["jquery","underscore","backbone","models/AppModel","views/AppView"],function(e,t,p,o,r){var l={},d=p.Router.extend({routes:{"":"start","*splat":"catchAll"}}),i=function(){l.Router=new d,l.AppModel=l.AppModel||new o({router:l.Router,chapter:""}),l.AppView=l.AppView||new r({el:e("#application"),model:l.AppModel}),l.Router.on("route:start",function(){l.AppModel.set("chapter-id","start"),l.AppModel.set("routeUpdated",(new Date).getTime())}),l.Router.on("route:catchAll",function(e){var e=e.split("/");l.AppModel.set("chapter-id",e[0]),l.AppModel.set("userScrolling",!1),e.length>1?l.AppModel.set("frame-id",e[1]):l.AppModel.set("frame-id",""),l.AppModel.set("routeUpdated",(new Date).getTime())}),p.history.start()};return{initialize:i}});